# 技術選定書

## 目的

本ドキュメントでは、QRコード対応多言語注文システムの開発に使用する技術スタックの選定理由を詳細に説明します。各技術の比較分析を通じて、プロジェクトの制約（開発期間3ヶ月、個人開発、Windows環境）に最適な選択を提示します。

---

## 1. モバイルアプリ開発フレームワーク

### 1.1 比較対象技術

#### Option A: Expo (React Native)
#### Option B: React Native CLI

### 1.2 詳細比較表

| 項目 | Expo | React Native CLI |
|------|------|-----------------|
| **セットアップ時間** | 5分程度 | 1-2時間 |
| **必要な前提知識** | JavaScript/React | JavaScript/React + ネイティブ開発 |
| **Android Studio必須** | 不要（Expo Goアプリで開発可） | 必須 |
| **Xcode必須（iOS）** | 不要 | 必須 |
| **開発環境** | Windows/Mac/Linux | Windows/Mac/Linux |
| **実機テスト** | Expo Goアプリで即座に可能 | エミュレータまたはビルド必要 |
| **QRコード機能** | expo-barcode-scanner（標準） | サードパーティライブラリ |
| **ビルド方法** | EAS Build（クラウドビルド） | ローカルビルド（環境構築複雑） |
| **アップデート配信** | OTA（Over-The-Air）更新可能 | ストア経由のみ |
| **ネイティブモジュール** | 制限あり（Expo SDK内） | 自由に追加可能 |
| **アプリサイズ** | やや大きい（30-40MB） | 最適化可能（15-25MB） |
| **学習コスト** | 低 | 中〜高 |
| **トラブルシューティング** | ドキュメント充実 | 複雑（環境依存問題多い） |
| **コミュニティ** | 活発 | 活発 |

### 1.3 推奨: Expo

#### 推奨理由

1. **開発期間の制約（3ヶ月）に対応**
   - セットアップが5分で完了
   - Android Studioの複雑な環境構築が不要
   - すぐに開発開始できる

2. **個人開発に最適**
   - 学習コストが低い
   - ドキュメントが充実
   - トラブルシューティングが容易

3. **Windows環境での開発**
   - Android Studio不要でAndroidアプリ開発が可能
   - Expo Goアプリで実機テストが即座に可能
   - エミュレータ経験がなくても問題なし

4. **プロジェクト要件との適合性**
   - QRコードスキャン機能が標準搭載（expo-barcode-scanner）
   - Firebase連携が容易（expo-firebase）
   - 多言語対応の実装がシンプル（expo-localization）

5. **評価実験での利便性**
   - Expo Goアプリで留学生に簡単に配布・テスト可能
   - QRコードを読み取るだけでアプリを起動できる
   - アップデートがOTAで即座に反映

#### デメリットと対策

| デメリット | 対策 | 影響度 |
|-----------|------|--------|
| ネイティブモジュール追加に制限 | 本プロジェクトではExpo SDK内の機能で十分 | 低 |
| アプリサイズがやや大きい | プロトタイプ段階では許容範囲 | 低 |
| 将来的な拡張性 | 必要に応じてeject可能 | 低 |

### 1.4 結論

**Expo を採用**

プロジェクトの制約（3ヶ月、個人開発、Windows環境、エミュレータ経験なし）を考慮すると、Expoが圧倒的に優位です。開発スピードを最大化し、実装に集中できる環境を提供します。

---

## 2. 翻訳API

### 2.1 比較対象技術

#### Option A: DeepL API
#### Option B: Google Translate API

### 2.2 詳細比較表

| 項目 | DeepL API | Google Translate API |
|------|-----------|---------------------|
| **対応言語数** | 31言語 | 100言語以上 |
| **日本語対応** | ○ | ○ |
| **中国語対応** | ○（簡体字・繁体字） | ○（簡体字・繁体字・粤語） |
| **英語対応** | ○ | ○ |
| **翻訳品質（一般）** | 非常に高い | 高い |
| **翻訳品質（日→英）** | 自然で流暢 | やや機械的 |
| **翻訳品質（日→中）** | 良好 | 良好 |
| **専門用語対応** | 文脈依存 | 文脈依存 |
| **無料枠** | 月50万文字 | なし |
| **有料料金** | €5.49/月（Starter）<br>€25/100万文字 | $20/100万文字 |
| **API呼び出し制限** | Freeプラン: 制限あり | 従量課金: 実質無制限 |
| **レスポンス速度** | 高速（平均200-500ms） | 高速（平均100-300ms） |
| **Firebase連携** | 可能（Cloud Functions経由） | 容易（公式ライブラリあり） |
| **ドキュメント** | 充実（英語・日本語） | 非常に充実（多言語） |
| **カスタム辞書機能** | 用語集機能あり（Glossary） | なし（文脈で対応） |
| **SDKサポート** | Node.js, Python等 | 多数の言語対応 |

### 2.3 翻訳品質比較例

#### 例1: 専門用語（料理名）

| 原文 | DeepL | Google Translate |
|------|-------|------------------|
| 炙りサーモン寿司 | Grilled salmon sushi | Seared salmon sushi |
| 豚の角煮 | Braised pork belly | Stewed pork cubes |
| 抹茶ティラミス | Matcha tiramisu | Matcha tiramisu |

#### 例2: 説明文

**原文**: 「新鮮な魚介を使用した、当店自慢の海鮮丼です。」

| API | 翻訳結果（英語） | 評価 |
|-----|----------------|------|
| DeepL | "This is our signature seafood rice bowl using fresh seafood." | 自然で流暢 |
| Google | "This is our proud seafood bowl using fresh seafood." | やや直訳的 |

**原文**: 「アレルギーのある方は事前にお申し出ください。」

| API | 翻訳結果（英語） | 評価 |
|-----|----------------|------|
| DeepL | "Please let us know in advance if you have any allergies." | 完璧 |
| Google | "If you have allergies, please inform us in advance." | 良好 |

### 2.4 予算・利用制限の分析

#### 想定利用量（3ヶ月開発期間）

| フェーズ | 想定翻訳量 | 説明 |
|---------|-----------|------|
| **開発・テスト** | 10万文字 | メニュー100項目 × 平均50文字 × 2言語 × 10回修正 |
| **評価実験** | 5万文字 | 留学生10名 × 30項目閲覧 × 50文字 × 2言語 × 繰り返し |
| **デモ・プレゼン** | 2万文字 | 追加テスト・デモンストレーション |
| **合計** | **約17万文字** | 安全マージン含めて20万文字 |

#### コスト試算

| API | 無料枠 | 超過分コスト | 合計コスト |
|-----|-------|------------|----------|
| **DeepL Free** | 50万文字/月 | - | **0円** |
| **DeepL Pro** | - | 17万文字 × €0.000025 = €4.25 | €4.25（約650円） |
| **Google Translate** | なし | 17万文字 × $0.00002 = $3.4 | $3.4（約500円） |

#### 推奨プラン

**段階的アプローチ**:
1. **開発初期（11月）**: DeepL Free プラン（50万文字/月）
2. **必要に応じて**: Google Translate API または DeepL Pro に切り替え

### 2.5 推奨: DeepL API（開発初期）+ Google Translate API（バックアップ）

#### 推奨理由

1. **無料枠の活用**
   - DeepL Freeプランで月50万文字まで無料
   - 本プロジェクトの想定利用量（月間約6-8万文字）を十分カバー
   - 予算制約のある卒業研究に最適

2. **翻訳品質**
   - 日本語→英語の翻訳が自然で流暢
   - 専門用語の翻訳も概ね良好
   - 用語集（Glossary）機能で専門用語を登録可能

3. **実装の柔軟性**
   - Node.js SDKが充実
   - Firebase Cloud Functionsとの連携が容易
   - 必要に応じてGoogle Translate APIに切り替え可能な設計

4. **研究としての価値**
   - 最新の翻訳技術（ニューラル機械翻訳）の活用
   - 論文で「DeepL API + 専門用語辞書」のハイブリッド手法として記述可能

#### 実装方針

```
翻訳API選択の優先順位:
1. DeepL API（通常時）
2. Google Translate API（フォールバック・比較評価用）
```

**切り替え可能な設計**:
- 抽象化レイヤーを実装し、APIを簡単に切り替え可能にする
- 評価実験時に両方のAPIで翻訳精度を比較

#### デメリットと対策

| デメリット | 対策 | 影響度 |
|-----------|------|--------|
| 無料枠の制限（50万文字/月） | 実際の利用量は月6-8万文字程度のため問題なし | 低 |
| APIレート制限 | 本プロジェクトの規模では制限に達しない | 低 |
| 将来的なコスト | Proプランでも月数百円程度 | 低 |

### 2.6 結論

**DeepL API を第一選択として採用、Google Translate API をバックアップとして併用**

無料枠を活用しつつ高品質な翻訳を実現し、必要に応じて柔軟に切り替え可能な設計とします。

---

## 3. バックエンド・データベース

### 3.1 選択技術: Firebase

#### 採用理由

1. **サーバーレスアーキテクチャ**
   - サーバー管理不要
   - スケーラビリティ自動対応
   - インフラコスト最小化

2. **豊富な機能セット**
   - Firestore（NoSQLデータベース）
   - Cloud Functions（サーバーサイド処理）
   - Authentication（認証機能）
   - Hosting（管理ダッシュボード用）

3. **開発スピード**
   - React Native（Expo）との統合が容易
   - リアルタイム同期機能
   - オフライン対応

4. **無料枠**
   - Spark プラン（無料）で開発・評価実験が可能
   - 小規模プロジェクトなら無料枠内で運用可能

### 3.2 Firebase無料枠の詳細

| サービス | 無料枠 | 本プロジェクトの想定使用量 | 超過可能性 |
|---------|-------|-------------------------|----------|
| **Firestore** | 1GB保存容量<br>50,000読取/日<br>20,000書込/日 | メニュー50項目 × 5KB = 250KB<br>読取: 約1,000/日<br>書込: 約100/日 | 極めて低い |
| **Cloud Functions** | 200万呼出/月<br>400,000GB秒/月 | 翻訳処理: 約5,000呼出/月 | なし |
| **Authentication** | 無制限 | 評価実験: 10-20ユーザー | なし |
| **Hosting** | 10GB転送/月 | 管理画面: 約100MB/月 | なし |

### 3.3 結論

**Firebase（Sparkプラン）を採用**

無料枠で十分に開発・評価実験が可能です。必要に応じてBlaze プラン（従量課金）に移行できる柔軟性もあります。

---

## 4. 形態素解析

### 4.0 研究上の重要性

**形態素解析は本研究の核心的要素**

本プロジェクトにおいて、形態素解析は単なる技術的選択ではなく、**研究の学術的価値を決定する重要な要素**です。

| 観点 | シンプルな辞書マッチングのみ | 形態素解析を用いた手法（本研究） |
|------|------------------------|--------------------------|
| **研究としての価値** | 低（既存技術の単純な組み合わせ） | 高（NLP技術の実践的応用） |
| **学術的新規性** | ほぼなし | 形態素解析 × 専門用語辞書 × 機械翻訳の融合 |
| **論文での主張** | 「辞書を作成した」程度 | 「形態素解析により専門用語を自動抽出し、翻訳精度を向上」 |
| **技術的難易度** | 低 | 中〜高 |

**形態素解析が必要な理由**:

1. **正確な単語境界の認識**:
   - シンプルマッチング: "炙りサーモン寿司" → "炙り"、"サーモン"、"寿司" を部分文字列検索（誤検出の可能性）
   - 形態素解析: Kuromoji.jsで正確に ["炙り"(名詞), "サーモン"(名詞), "寿司"(名詞)] と分割

2. **研究の学術的意義**:
   - 単なるシステム開発ではなく、自然言語処理技術の実践的応用
   - 評価実験で形態素解析の有効性を定量的に証明可能

3. **卒業研究として十分な深さ**:
   - 技術選定の根拠
   - 実装の工夫
   - 効果測定と考察

**結論**: 形態素解析を省略すると、本プロジェクトは「翻訳APIを使っただけのシステム」となり、研究としての価値が大きく低下します。Kuromoji.jsを用いることで、実装の困難性を抑えつつ研究価値を維持します。

### 4.1 比較対象技術

#### Option A: MeCab（フルスペック）
#### Option B: Kuromoji.js（JavaScript版軽量形態素解析）

### 4.2 詳細比較表

| 項目 | MeCab | Kuromoji.js |
|------|-------|------------|
| **言語** | C++ | JavaScript |
| **実行環境** | サーバー（要インストール） | Node.js（Cloud Functions） |
| **辞書サイズ** | 大（数十MB） | 中（約10MB） |
| **解析精度** | 非常に高い | 高い |
| **処理速度** | 非常に高速 | 高速 |
| **導入難易度** | 高（バイナリインストール必要） | 低（npm install） |
| **Firebase連携** | 複雑（カスタムランタイム必要） | 容易 |
| **メンテナンス** | 複雑 | 簡単 |

### 4.3 推奨: Kuromoji.js

#### 推奨理由

1. **Firebase Cloud Functionsとの親和性**
   - Node.js環境で直接動作
   - 追加のセットアップ不要

2. **開発効率**
   - `npm install kuromoji` だけで導入完了
   - メンテナンスが容易

3. **本プロジェクトの要件に十分**
   - メニューテキストの形態素解析には十分な精度
   - 専門用語抽出レベルの処理なら問題なし

4. **コールドスタート時間**
   - MeCabよりも起動が高速
   - Cloud Functionsのコールドスタート時間を短縮

#### 実装方針

**実装場所の選択**:

3ヶ月の開発期間を考慮し、**フロントエンド（React Native）での実装**を推奨します。

| 実装場所 | メリット | デメリット |
|---------|---------|-----------|
| **フロントエンド（推奨）** | ・実装が容易<br>・デバッグが簡単<br>・ネットワーク非依存<br>・サーバーコスト不要 | ・アプリサイズ増加（辞書データ~10MB） |
| **Cloud Functions** | ・集中管理<br>・辞書更新が容易 | ・ネットワーク必須<br>・コールドスタート<br>・デバッグが複雑 |

**処理フロー（フロントエンド実装）**:
```
1. React Nativeアプリ内でKuromoji.js実行
2. 形態素解析で単語分割
3. アプリに同梱した専門用語辞書とマッチング
4. 翻訳API呼び出し（コンテキスト付与）
5. 翻訳結果の補正
```

**フォールバック戦略**:
- Level 1: 形態素解析 + 辞書マッチング（主要手法）
- Level 2: シンプル辞書マッチング（形態素解析失敗時）
- Level 3: API翻訳のみ（辞書失敗時）

詳細は [translation_system_design.md](./translation_system_design.md) を参照。

### 4.4 結論

**Kuromoji.js をフロントエンドに採用**

開発効率、本プロジェクトの要件への適合性、そして3ヶ月の開発期間を考慮し、React NativeでのKuromoji.js実装が最適です。これにより、研究の核心である形態素解析の有効性を実証しつつ、実装の困難性を最小限に抑えます。

---

## 5. 開発・テスト環境

### 5.1 推奨構成

#### 開発マシン
- **OS**: Windows 11
- **エディタ**: Visual Studio Code
- **Node.js**: v18 LTS以降
- **パッケージマネージャ**: npm または yarn

#### テスト環境
- **実機テスト**: Expo Goアプリ（Androidスマートフォン）
- **エミュレータ**: 不要（Expo Goで代替）

### 5.2 Android Studioが不要な理由

| 従来の開発 | Expo開発 |
|-----------|---------|
| Android Studio必須 | 不要 |
| エミュレータセットアップ（1-2時間） | Expo Goアプリ（5分） |
| ビルド時間（5-10分） | 即座に反映（HMR） |
| デバイス接続設定複雑 | Wi-Fi経由で自動接続 |

### 5.3 推奨VSCode拡張機能

| 拡張機能 | 用途 |
|---------|------|
| ES7+ React/Redux/React-Native snippets | コード補完 |
| Prettier | コードフォーマット |
| ESLint | コード品質チェック |
| React Native Tools | デバッグ支援 |
| Firebase Explorer | Firebase管理 |

### 5.4 結論

**Expo Go + 実機テスト環境を採用**

Android Studioの複雑な環境構築を回避し、開発効率を最大化します。

---

## 6. バージョン管理

### 6.1 推奨: Git + GitHub

#### 採用理由

1. **成果物の保護**
   - ローカルのみの場合、PCトラブル時にすべて失う
   - GitHubで安全にバックアップ

2. **開発履歴の記録**
   - 卒業研究として開発プロセスの記録が重要
   - コミット履歴が論文の根拠になる

3. **無料プライベートリポジトリ**
   - GitHub Freeプランで無制限のプライベートリポジトリ
   - コスト負担なし

4. **論文での記述**
   - 「適切なバージョン管理を実施」と記載可能
   - 研究の信頼性向上

### 6.2 最小限のセットアップ

```bash
# ローカルリポジトリ初期化
git init

# 初回コミット
git add .
git commit -m "Initial commit"

# GitHubリポジトリ作成（プライベート）
gh repo create qr-multilingual-order-system --private

# プッシュ
git push -u origin main
```

### 6.3 結論

**Git + GitHub を開発初期から使用**

最小限の手間で最大限の安全性と研究としての価値を確保します。

---

## 7. 技術スタック総括

### 7.1 最終選定技術一覧

| レイヤー | 選定技術 | 代替候補 |
|---------|---------|---------|
| **フロントエンド** | Expo (React Native) | React Native CLI |
| **翻訳API** | DeepL API | Google Translate API |
| **バックエンド** | Firebase (Firestore, Cloud Functions) | - |
| **形態素解析** | Kuromoji.js | MeCab |
| **QRコード** | expo-barcode-scanner | - |
| **テスト環境** | Expo Go（実機） | Android Studio Emulator |
| **バージョン管理** | Git + GitHub | - |
| **エディタ** | Visual Studio Code | - |

### 7.2 技術選定の判断基準

| 基準 | 重要度 | 説明 |
|------|-------|------|
| **開発期間（3ヶ月）** | 最高 | 短期間で実装完了できる技術を優先 |
| **個人開発** | 高 | 学習コストが低く、ドキュメントが充実 |
| **Windows環境** | 高 | Windows環境で問題なく動作 |
| **予算制約** | 高 | 無料枠で開発・評価実験が可能 |
| **拡張性** | 中 | 将来的な機能追加に対応可能 |
| **論文への記述** | 中 | 最新技術・適切な設計として記述可能 |

### 7.3 リスクと対策

| リスク | 発生確率 | 影響度 | 対策 |
|-------|---------|-------|------|
| DeepL無料枠超過 | 低 | 低 | Google Translate APIに切り替え |
| Firebase無料枠超過 | 極めて低 | 中 | Blazeプランに移行（月数百円） |
| Expoの機能制限 | 低 | 中 | 必要に応じてeject |
| 翻訳精度不足 | 中 | 高 | 専門用語辞書で補完 |

---

## 更新履歴

| 日付 | 更新内容 | 担当者 |
|------|---------|--------|
| 2024-11-19 | 初版作成 | - |
